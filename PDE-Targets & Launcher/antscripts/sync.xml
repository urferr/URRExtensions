<project name="Sync Development Libraries" default="syncXentisServerLibraries">
	<property name="workspace.loc" value="${basedir}" />

	<target name="syncXentisServerLibraries" depends="-checkPrerequisites" description="updates all Xentis server libraries on the development server">
		<echo>workspace.loc: ${workspace.loc}</echo>
		<echo>xentis.home: ${xentis.home}</echo>
		<echo>maven.build.version: ${maven.build.version}</echo>
		<echo>target directory: ${${xentis.home}/packages/XENTIS/lib}</echo>

		<copy todir="${xentis.home}/packages/XENTIS/lib" overwrite="true" verbose="true" flatten="true">
			<fileset dir="${workspace.loc}">
				<include name="URRExtensions/maven/com.xnife.context.maven/target/com.xnife.context-${maven.build.version}.jar" />
				<include name="URRExtensions/maven/com.xnife.contract.maven/target/com.xnife.contract-${maven.build.version}.jar" />
				<include name="URRExtensions/maven/com.xnife.core.maven/target/com.xnife.core-${maven.build.version}.jar" />
				<include name="URRExtensions/maven/com.xnife.domain.maven/target/com.xnife.domain-${maven.build.version}.jar" />
				<include name="URRExtensions/maven/com.xnife.environment.maven/target/com.xnife.environment-${maven.build.version}.jar" />
				<include name="URRExtensions/maven/com.xnife.http.maven/target/com.xnife.http-${maven.build.version}.jar" />
				<include name="URRExtensions/maven/com.xnife.localization.maven/target/com.xnife.localization-${maven.build.version}.jar" />
				<include name="URRExtensions/maven/com.xnife.logging.maven/target/com.xnife.logging-${maven.build.version}.jar" />
				<include name="URRExtensions/maven/com.xnife.logging.impl.maven/target/com.xnife.logging.impl-${maven.build.version}.jar" />
				<include name="URRExtensions/maven/com.xnife.logging.log4j.maven/target/com.xnife.logging.log4j-${maven.build.version}.jar" />
				<include name="URRExtensions/maven/com.xnife.metadata.maven/target/com.xnife.metadata-${maven.build.version}.jar" />
				<include name="URRExtensions/maven/com.xnife.objectquery.maven/target/com.xnife.objectquery-${maven.build.version}.jar" />
				<include name="URRExtensions/maven/com.xnife.remoting.maven/target/com.xnife.remoting-${maven.build.version}.jar" />
				<include name="URRExtensions/maven/com.xnife.security.maven/target/com.xnife.security-${maven.build.version}.jar" />
				<include name="URRExtensions/maven/com.xnife.spring.maven/target/com.xnife.spring-${maven.build.version}.jar" />

				<include name="URRExtensions/eclipse/com.profidatagroup.xentis.jni.common.ide/target/com.profidata.xentis.jni.common-${maven.build.version}.jar" />
				<include name="JavAMIS/com.profidata.xentis.env.shared/target/com.profidata.xentis.env.shared-${maven.build.version}.jar" />
				<include name="JavAMIS/com.profidata.xentis.jms.shared/target/com.profidata.xentis.jms.shared-${maven.build.version}.jar" />
				<include name="JavAMIS/XentisBODomain/target/com.profidata.xentis.bodomain-${maven.build.version}.jar" />

				<include name="URRExtensions/maven/com.compxc.platform.common.maven/target/com.compxc.platform.common-${maven.build.version}.jar" />
				<include name="URRExtensions/maven/com.compxc.common.domain.maven/target/com.compxc.common.domain-${maven.build.version}.jar" />
				<include name="URRExtensions/maven/com.compxc.common.persistence.maven/target/com.compxc.common.persistence-${maven.build.version}.jar" />
				<include name="URRExtensions/maven/com.compxc.common.metadata.maven/target/com.compxc.common.metadata-${maven.build.version}.jar" />
				<include name="URRExtensions/maven/com.profidata.xc.data.service.domain.maven/target/com.profidata.xc.data.service.domain-${maven.build.version}.jar" />
				<include name="URRExtensions/maven/com.profidata.xc.data.service.maven/target/com.profidata.xc.data.service-${maven.build.version}.jar" />
				<include name="URRExtensions/maven/com.profidata.xc.codevalue.maven/target/com.profidata.xc.codevalue-${maven.build.version}.jar" />
				<include name="URRExtensions/maven/com.profidata.xc.metadata.maven/target/com.profidata.xc.metadata-${maven.build.version}.jar" />
				<include name="URRExtensions/maven/com.profidata.xc.persistence.maven/target/com.profidata.xc.persistence-${maven.build.version}.jar" />
				<include name="URRExtensions/maven/com.profidata.xc.unified.service.maven/target/com.profidata.xc.unified.service-${maven.build.version}.jar" />

				<include name="URRExtensions/maven/com.compxc.frontoffice.common.maven/target/com.compxc.frontoffice.common-${maven.build.version}.jar" />

				<include name="JavAMIS/com.profidata.xentis.domain.unified/target/com.profidata.xentis.domain.unified-${maven.build.version}.jar" />
				<include name="JavAMIS/com.profidata.xentis.server.commons/target/com.profidata.xentis.server.commons-${maven.build.version}.jar" />
				<include name="JavAMIS/com.profidata.xentis.env.server/target/com.profidata.xentis.env.server-${maven.build.version}.jar" />
				<include name="JavAMIS/com.profidata.xentis.jms.server/target/com.profidata.xentis.jms.server-${maven.build.version}.jar" />
				<include name="JavAMIS/com.profidata.xentis.user.shared/target/com.profidata.xentis.user.shared-${maven.build.version}.jar" />
				<include name="JavAMIS/com.profidata.xentis.user.server/target/com.profidata.xentis.user.server-${maven.build.version}.jar" />
				<include name="JavAMIS/com.profidata.xentis.user.ldap/target/com.profidata.xentis.user.ldap-${maven.build.version}.jar" />
				<include name="JavAMIS/com.profidata.xentis.ratex/target/com.profidata.xentis.ratex-${maven.build.version}.jar" />
				<include name="JavAMIS/com.profidatagroup.xentis.jni/target/com.profidata.xentis.jni-${maven.build.version}.jar" />
				<include name="JavAMIS/com.profidata.xentis.sn/target/com.profidata.xentis.sn-${maven.build.version}.jar" />
				<include name="JavAMIS/XentisBOServer/target/com.profidata.xentis.server-${maven.build.version}.jar" />
				<include name="JavAMIS/com.profidata.xentis.server.bloomberg/target/com.profidata.xentis.server.bloomberg-${maven.build.version}.jar" />
				<include name="URRExtensions/maven/com.profidata.javamis/target/com.profidata.javamis-${maven.build.version}.jar" />
				<include name="JavAMISXC/JavAMISXC/target/com.profidata.javamisxc-${maven.build.version}.jar" />
				<include name="xrs/com.profidata.risk.commons/target/com.profidata.risk.commons-${maven.build.version}.jar" />
				<include name="fix/com.profidata.xentis.fix.engine.commons/target/com.profidata.xentis.fix.commons-${maven.build.version}.jar" />
				<include name="xtl/com.profidata.xentis.etl.commons/target/com.profidata.xentis.etl.commons-${maven.build.version}.jar" />
				<include name="reporting/com.profidata.reporting.common/target/com.profidata.reporting.common-${maven.build.version}.jar" />
				<include name="JavAMIS/com.profidata.xentis.env.client/target/com.profidata.xentis.env.client-${maven.build.version}.jar" />
				<include name="JavAMIS/com.profidatagroup.xentis.ui.base/target/com.profidata.xentis.ui.base-${maven.build.version}.jar" />
				<include name="JavAMIS/XentisBOClient/target/com.profidata.xentis.client-${maven.build.version}.jar" />
			</fileset>
		</copy>
	</target>

	<target name="syncGeneratedJniSources" depends="-checkPrerequisites" description="replaces all the jni/jc source in com.profidatagroup.xentis.jni project">
		<echo>workspace.loc: ${workspace.loc}</echo>
		<echo>xentis.home: ${xentis.home}</echo>
		<echo>maven.build.version: ${maven.build.version}</echo>
		<echo>target directory: ${workspace.loc}/com.profidatagroup.xentis.jni/targets</echo>

		<delete quiet="true">
			<fileset dir="${workspace.loc}/JavAMIS/com.profidatagroup.xentis.jni/src/main/java" includes="**/*"  />
		</delete>

		<copy todir="${workspace.loc}/JavAMIS/com.profidatagroup.xentis.jni/target" overwrite="true" verbose="true">
			<fileset dir="${xentis.home}/builddir/java/XENTIS/shared/com.profidata.xentis.jni">
				<include name="com.profidata.xentis.jni-${maven.build.version}-sources.jar" />
			</fileset>
		</copy>

		<unzip src="${workspace.loc}/JavAMIS/com.profidatagroup.xentis.jni/target/com.profidata.xentis.jni-${maven.build.version}-sources.jar" dest="${workspace.loc}/JavAMIS/com.profidatagroup.xentis.jni/src/main/java">
			<patternset>
				<include name="jni/*.java" />
				<include name="jc/*.java" />
			</patternset>
		</unzip>

		<delete file="${workspace.loc}/JavAMIS/com.profidatagroup.xentis.jni/target/com.profidata.xentis.jni-${maven.build.version}-sources.jar" />
	</target>

	<!-- global helpers -->
	<target name="-checkPrerequisites">
		<check-required-property propertyname="workspace.loc" />
		<check-required-property propertyname="xentis.home" />
		<check-required-property propertyname="maven.build.version" />
	</target>

	<macrodef name="check-required-property">
		<attribute name="propertyName" />
		<sequential>
			<fail message="The required property '@{propertyName}' is not specified -- use '-D@{propertyName}=value' as command line argument (or set property in calling ant script)" unless="@{propertyName}" />
		</sequential>
	</macrodef>
</project>

